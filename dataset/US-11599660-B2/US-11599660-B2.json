{
    "patent_id": "US-11599660-B2",
    "title": "Dynamic policy based on user experience ",
    "assignee": "Sophos Limited",
    "publication_date": "2023-03-07",
    "patent_link": "https://patents.google.com/patent/US11599660B2/en",
    "inventors": [
        "Joseph H. Levy",
        "Andrew J. Thomas",
        "Daniel Salvatore Schiappa",
        "Kenneth D. Ray"
    ],
    "classifications": [
        "G06F21/6218",
        "G06F21/45",
        "G06F16/137",
        "G06F16/285",
        "G06F16/93",
        "G06F21/577",
        "G06F21/64",
        "G06N20/00",
        "G06N3/0675",
        "G06N5/046",
        "G06N5/048",
        "H04L41/20",
        "H04L41/22",
        "H04L63/08",
        "H04L63/0807",
        "H04L63/083",
        "H04L63/0838",
        "H04L63/0861",
        "H04L63/101",
        "H04L63/102",
        "H04L63/1408",
        "H04L63/1416",
        "H04L63/1425",
        "H04L63/1433",
        "H04L63/1441",
        "H04L63/20",
        "H04L63/205",
        "H04L9/0891",
        "H04L9/16",
        "H04L9/3226",
        "H04L9/3265",
        "H04L9/50",
        "G06F2221/034",
        "H04L2463/082",
        "H04L9/3213",
        "H04L9/3228",
        "H04L9/3231",
        "H04L9/3271"
    ],
    "abstract": "Entity models are used to evaluate potential risk of entities, either individually or in groups, in order to evaluate suspiciousness within an enterprise network. These individual or aggregated risk assessments can be used to adjust the security policy for compute instances within the enterprise network. A security policy may specify security settings such as network speed, filtering levels, network isolation, levels of privilege, and the like.",
    "claims": "\n1. A computer program product comprising computer executable code embodied in a non-transitory computer readable medium that, when executing on one or more computing devices, performs the steps of:\nstoring an entity model for an entity at a threat management facility for an enterprise network, the entity including at least one of an identity and access management system, a domain controller, a physical device, a user, an operating system, or an application associated with the enterprise network, and the entity model characterizing a baseline of expected events based on events from the entity over an historical window as a vector in an event vector space;\ninstrumenting a compute instance associated with the entity to report event vectors based on one or more events from one or more sensors associated with the compute instance;\nreceiving an event stream at the threat management facility, the event stream including a plurality of event vectors from the compute instance;\nmonitoring the event stream and creating the entity model based on a baseline of event vectors for the entity in the event stream over an interval, wherein the interval is algorithmically determined;\ncalculating a risk score for the compute instance based on a distance between the entity model and one or more event vectors in the event stream in the event vector space; and\nadjusting local monitoring activity on the compute instance to increase a level of local activity monitoring when the risk score indicates a deviation from the baseline.\n2. The computer program product of claim 1, wherein the historical window is algorithmically determined.\n3. The computer program product of claim 1, wherein the threat management facility stores a plurality of entity models for a plurality of different entity types within the enterprise network.\n4. The computer program product of claim 1, wherein the event stream includes event vectors from a plurality of compute instances associated with the enterprise network.\n5. The computer program product of claim 1, wherein the event stream includes event vectors from two or more different entities associated with the compute instance.\n6. The computer program product of claim 1, further comprising code that performs the step of refining the entity model based on additional event vectors in the event stream received after the entity model is created.\n7. The computer program product of claim 6, wherein the step of refining the entity model is based on an interval determined from information contained in the additional event vectors.\n8. The computer program product of claim 7, wherein refining the entity model is based on a distance in the event vector space between the entity model and one or more of the additional event vectors in the event stream.\n9. The computer program product of claim 1, wherein instrumenting the compute instance includes configuring the compute instance to normalize at least one of the events from at least one of the one or more sensors.\n10. The computer program product of claim 1, wherein instrumenting the compute instance includes configuring the compute instance to tokenize at least one of the events from at least one of the one or more sensors.\n11. The computer program product of claim 1, wherein instrumenting the compute instance includes configuring the compute instance to encrypt at least one of the events from at least one of the one or more sensors.\n12. The computer program product of claim 1, wherein instrumenting the compute instance includes prioritizing at least one of the events from at least one of the one or more sensors.\n13. The computer program product of claim 1, wherein the distance is at least one of a Mahalanobis distance, a Euclidean distance, and a Minkowski distance.\n14. The computer program product of claim 1, wherein the distance is evaluated using a k-nearest neighbor algorithm.\n15. A method, comprising:\nstoring an entity model at a threat management facility for an enterprise network, the entity model characterizing expected events for an entity;\ninstrumenting a compute instance in the enterprise network to detect one or more events and report a number of event vectors including the one or more events to the threat management facility;\nreceiving an event stream of the number of event vectors from the compute instance at the threat management facility;\nmonitoring the event stream and creating the entity model based on a baseline of event vectors for the entity in the event stream over an interval, wherein the interval is algorithmically determined;\ncalculating a risk score for the compute instance based on a comparison of one or more of the event vectors in the event stream with the entity model for the entity; and\nadjusting local monitoring activity on the compute instance to increase a level of local activity monitoring when the risk score indicates a deviation from the baseline.\n16. The method of claim 15, further comprising refining the entity model based on additional event vectors in the event stream received after the entity model is created.\n17. The method of claim 16, wherein refining the entity model is based on an interval determined from information contained in the additional event vectors.\n18. The method of claim 15, wherein the event stream includes event vectors from a plurality of compute instances associated with the enterprise network.\n19. The method of claim 15, wherein the event stream includes event vectors from two or more different entities associated with the compute instance.\n20. A system, comprising:\na compute instance in an enterprise network, the compute instance configured to detect one or more events associated with the compute instance and to report an event vector including the one or more events to a remote resource; and\na threat management facility, the threat management facility including a memory storing an entity model characterizing expected events for an entity, and the threat management facility configured to receive an event stream including the event vector, to monitor the event stream, to create the entity model based on a baseline of event vectors for the entity in the event stream over an algorithmically determined interval, to calculate a risk score for the compute instance based on a comparison of the event vector with the entity model, and to adjust local monitoring activity on the compute instance to increase a level of local activity monitoring when the risk score indicates a deviation from the baseline."
}