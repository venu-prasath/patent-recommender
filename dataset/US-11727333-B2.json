{
    "patent_id": "US-11727333-B2",
    "title": "Endpoint with remotely programmable data recorder ",
    "assignee": "Sophos Limited",
    "publication_date": "2023-08-15",
    "patent_link": "https://patents.google.com/patent/US11727333B2/en",
    "inventors": [
        "Beata Ladnai",
        "Mark David Harris",
        "Andrew G. P. Smith",
        "Kenneth D. Ray",
        "Andrew J. Thomas",
        "Russell Humphries"
    ],
    "classifications": [
        "G06Q10/0635",
        "G06F11/079",
        "G06F16/955",
        "G06F17/18",
        "G06F18/214",
        "G06F18/2178",
        "G06F18/23213",
        "G06F18/24143",
        "G06F21/554",
        "G06F21/56",
        "G06F21/562",
        "G06F21/565",
        "G06F9/542",
        "G06N20/00",
        "G06N20/20",
        "G06N5/01",
        "G06N5/022",
        "G06N5/04",
        "G06N5/046",
        "G06N7/00",
        "G06Q10/06395",
        "G06V20/52",
        "H04L63/0227",
        "H04L63/0263",
        "H04L63/1408",
        "H04L63/1416",
        "H04L63/1425",
        "H04L63/1433",
        "H04L63/1441",
        "H04L63/20",
        "G06Q30/0185",
        "G06Q30/0283"
    ],
    "abstract": "An endpoint coupled in a communicating relationship with an enterprise network may include a data recorder configured to store an event stream of data indicating events on the endpoint including types of changes to computing objects, a filter configured to locally process the event stream into a filtered event stream including a subset of types of changes to the computing objects, and a local security agent. The local security agent may be configured to transmit the filtered event stream to a threat management facility, respond to a filter adjustment from the threat management facility by adjusting the filter to modify the subset of types of changes included in the filtered event stream, and respond to a query from the threat management facility by retrieving data stored in the data recorder over a time window before the query and excluded from the filtered event stream.",
    "claims": "\n1. An endpoint coupled in a communicating relationship with an enterprise network, the endpoint comprising:\na data recorder configured to store an event stream of data indicating events on the endpoint including a plurality of types of changes to a plurality of computing objects on the endpoint;\na filter configured to locally process the event stream into a filtered event stream including a subset of the plurality of types of changes to the plurality of computing objects; and\na local security agent configured to:\ntransmit the filtered event stream to a threat management facility;\nrespond to a filter adjustment from the threat management facility by adjusting the filter to modify the subset of the plurality of types of changes included in the filtered event stream; and\nrespond to a query from the threat management facility by retrieving data stored in the data recorder over a time window before the query and excluded from the filtered event stream.\n2. The endpoint of claim 1, wherein the local security agent is further configured to receive a remediation of a malware threat detected on the endpoint from the threat management facility.\n3. The endpoint of claim 1, wherein the event stream includes a plurality of causally related events.\n4. The endpoint of claim 1, wherein the local security agent responds to the query by transmitting the data excluded from the filtered event stream to the threat management facility.\n5. The endpoint of claim 1, wherein the filter is adjusted in response to a malware detection on the endpoint.\n6. The endpoint of claim 1, wherein the plurality of computing objects includes a process.\n7. The endpoint of claim 1, wherein the plurality of computing objects includes an executable.\n8. The endpoint of claim 1, wherein the plurality of computing objects includes at least one of an electronic communication, a registry of system settings, and a secure kernel cache.\n9. The endpoint of claim 1, wherein the types of changes include at least one of a file read, a file write, and a file copy.\n10. The endpoint of claim 1, wherein the types of changes include at least one of a file encrypt and a file decrypt.\n11. The endpoint of claim 1, wherein the types of changes include at least one of a registry update, a software installation, a change in permissions, and a remote resource query.\n12. The endpoint of claim 1, wherein the filter adjustment includes an addition of one or more of the types of changes to the filtered event stream.\n13. The endpoint of claim 1, wherein the filter adjustment includes a removal of one or more of the types of changes from the filtered event stream.\n14. The endpoint of claim 1, wherein the filter adjustment includes a modification to the types of changes to improve detection of malware on the endpoint by the threat management facility.\n15. The endpoint of claim 1, wherein the local security agent performs local detections of malware threats on the endpoint.\n16. The endpoint of claim 1, further comprising a query interface for receiving the query from a remote resource.\n17. The endpoint of claim 1, wherein the local security agent is configured to transmit the filtered event stream to the threat management facility by causing the data recorder to transmit the filtered event stream to the threat management facility.\n18. The endpoint of claim 1, wherein the local security agent is configured to adjust the filter based on a locally detected reputation score for at least one process or file on the endpoint.\n19. The endpoint of claim 1, wherein the filter is adjusted in response to a change in a policy compliance of the endpoint.\n20. The endpoint of claim 1, wherein the filter is adjusted to remove personal identifying information from the filtered event stream."
}