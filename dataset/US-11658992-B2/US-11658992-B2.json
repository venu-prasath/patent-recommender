{
    "patent_id": "US-11658992-B2",
    "title": "Lateral movement candidate detection in a computer network ",
    "assignee": "Splunk Inc.",
    "publication_date": "2023-05-23",
    "patent_link": "https://patents.google.com/patent/US11658992B2/en",
    "inventors": [
        "Satheesh Kumar JOSEPH DURAIRAJ",
        "Stanislav Miskovic",
        "Georgios Apostolopoulos"
    ],
    "classifications": [
        "H04L63/1425",
        "G06F16/9024",
        "G06F21/316",
        "G06F21/552",
        "G06F21/554",
        "G06N20/00",
        "G06N5/022",
        "H04L41/142",
        "H04L41/145",
        "H04L41/22",
        "G06N7/005",
        "G06N7/01"
    ],
    "abstract": "A lateral movement application identifies lateral movement (LM) candidates that potentially represent a security threat. Security platforms generate event data when performing security-related functions, such as authenticating a user account. The disclosed technology enables greatly increased accuracy identification of lateral movement (LM) candidates by, for example, refining a population of LM candidates based on an analysis of a time constrained graph in which nodes represent entities, and edges between nodes represent a time sequence of login or other association activities between the entities. The graph is created based on an analysis of the event data, including time sequences of the event data.",
    "claims": "\n1. A method, comprising:\naccessing, by a computer system, event data indicative of events related to a plurality of entities associated with a network;\naccessing a data store that includes data associated with selected events, wherein the selected events are indicative of lateral movement, and wherein each of the selected events has an associated weight factor;\nidentifying, by the computer system, based on the event data, lateral movement candidate entities, wherein identifying the lateral movement candidate entities comprises, for each entity of the plurality of entities:\nidentifying a subset of the event data that is associated with the entity;\nobtaining, based on the data store access, a weight factor for each event of the subset of event data;\ncalculating an entity weight factor for the entity based on the weight factor for each event; and\nwhen the entity weight factor is above a threshold, identifying the entity as a lateral movement candidate entity;\ncreating, by the computer system, based on the event data, a graph data structure that is indicative of a sequence of events associated with the lateral movement candidate entities; and\nanalyzing, by the computer system, the graph data structure to identify a potential security threat by identifying a subset of the lateral movement candidate entities that are associated with a particular observed sequence of events in the plurality of observed sequences of events.\n2. The method of claim 1, wherein each entity of the plurality of entities is a user account, a computing device, or an application, and wherein the graph data structure represents a time constrained graph.\n3. The method of claim 1, wherein the graph data structure is indicative of a plurality of nodes and one or more connections between the nodes, and each of the nodes represents an entity of the plurality of entities.\n4. The method of claim 1, wherein each of the nodes is associated, via the graph data structure, with a feature vector that is derived from a set of events that are associated with the node, and wherein a connection from a first node to a second node represents a sequence of events.\n5. The method of claim 1, wherein each of the nodes is associated, via the graph data structure, with a feature vector that is derived from a set of events that are associated with the node, and wherein a connection from a first node to a second node represents a sequence of events, wherein the sequence of events includes a first event associated with the first node that occurred before a second event associated with the second node, wherein a connection from the first node to the second node in the graph data structure represents a determination that the first event occurred before the second event, and wherein the first event and the second event are part of the particular sequence of events.\n6. The method of claim 1, wherein the event data include data obtained from a log file generated by a security platform, wherein the security platform is any of Active Directory, a firewall, an endpoint application, or an application that generates event data, wherein the event data is streamed by a security platform, and wherein the event data is accessed by receiving the streamed event data.\n7. The method of claim 1, wherein the creating the graph data structure that is indicative of the sequence of events includes:\nassociating data with a node of the graph data structure, wherein the data is derived from a subset of the event data associated with the node;\nanalyzing the event data to determine the sequence of events; and\ncreating connections between the nodes to represent the sequence of events.\n8. The method of claim 1, wherein the creating the graph data structure that is indicative of the sequence of events includes:\nfor each entity of the plurality of entities:\ncreating a node in a data structure to represent the entity;\nidentifying a subset of the event data that are associated with the node;\ncreating a feature vector that is derived from the subset of the event data; and\nassociating the feature vector with the node;\nanalyzing the event data to determine the sequence of events; and\ncreating connections between the nodes to represent the sequence of events.\n9. The method of claim 1, wherein the creating the graph data structure that is indicative of the sequence of events includes:\nassociating one or more feature vectors with a node that represents an entity, wherein each of the one or more feature vectors is derived from the subset of the event data and has an associated weight factor;\ncreating connections between the node and other nodes to represent the sequence of events; and\ncalculating a path value for a path based on entity and feature weight factors.\n10. The method of claim 1, wherein the analyzing the graph data structure to identify the potential security threat further includes:\naccessing a data store that includes data associated with a plurality of sequences of events, wherein each of the sequences of events is indicative of lateral movement;\ndetermining, based on the data store access, that the sequences of events include the particular sequence of events; and\nidentifying the subset of lateral movement candidate entities by determining which of the plurality of entities are associated with the particular sequence of events.\n11. The method of claim 1, wherein the analyzing the graph data structure to identify the potential security threat further includes:\naccessing a data store that includes data associated with a plurality of sequences of events, wherein each of the sequences of events is indicative of lateral movement;\ndetermining, based on the data store access, that the sequences of events include the particular sequence of events; and\nidentifying the subset of lateral movement candidate entities by determining which of the plurality of entities are associated with the particular sequence of events, wherein each sequence of the plurality of sequences of events was included in the data store after a determination was made that the sequence is indicative of lateral movement.\n12. The method of claim 1, wherein the analyzing the graph data structure to identify the potential security threat further includes determining which of the plurality of entities are the lateral movement candidate entities after a determination was made that a particular subset of the entities is associated with a particular set of feature vectors that are associated with the particular sequence of network events.\n13. The method of claim 1, wherein the identifying the lateral movement candidate entities includes identifying a particular entity as being a lateral movement candidate entity based on a determination that a particular event associated with the particular entity is one of:\nan event that meets a requirement for being classified as a rare event,\nan event that is indicative of a blacklisted application or process,\nan event that is indicative of a user enumeration attack,\nan event that is indicative of an anomalous event,\nan event that is indicative of a privilege elevation,\nan event that is indicative of a security violation,\nan event that is indicative of a suspicious task,\nan event that is indicative of a number of process creation events above a predetermined threshold,\nan event that is indicative of a number of ports scanned above a predetermined threshold,\nan event that is indicate of expanding access,\nan event that is indicative of a shadow copy of Active Directory data,\nan event that is indicative of suspicious activity, or\nan event that is indicative of a suspicious login chain.\n14. The method of claim 1, wherein the identifying the lateral movement candidate entities includes identifying a particular entity as being a lateral movement candidate entity based on a determination that a particular event associated with the particular entity is indicative of a shadow copy of Active Directory data, and wherein the particular event comprises a plurality of events.\n15. The method of claim 1, wherein the identifying the lateral movement candidate entities includes identifying a particular entity as being a lateral movement candidate entity based on a determination that a particular event associated with the particular entity is an event that meets a requirement for being classified as a rare event, and wherein the requirement for a particular event being classified as a rare event is that the particular event occurs with a frequency below a predetermined threshold.\n16. The method of claim 1, wherein the identifying the lateral movement candidate entities includes identifying a particular entity as being a lateral movement candidate entity based on a determination that a particular event associated with the particular entity is an event that is indicative of a blacklisted application or process, and wherein the particular event is indicative of a blacklisted application or process when the particular event is associated with an application or process that is included in a data store of blacklisted applications or processes.\n17. The method of claim 1, wherein the particular sequence of events includes a first event that is indicative of a privilege elevation associated with a user account, and a second event that is indicative of a login associated with the user account.\n18. The method of claim 1, wherein the identifying the lateral movement candidate entities includes identifying a particular entity as being a lateral movement candidate entity based on a determination that a particular event associated with the particular entity is an event that is indicative of:\na suspicious login chain,\na privilege elevation,\na user enumeration attack,\na number of process creation events above a predetermined threshold, or\na number of ports scanned above a predetermined threshold.\n19. A computing device, comprising:\na processor; and\na memory storing instructions that, when executed by the processor, cause the processor to perform a process including:\naccessing, by a computer system, event data indicative of events related to a plurality of entities associated with a network;\naccessing a data store that includes data associated with selected events, wherein the selected events are indicative of lateral movement, and wherein each of the selected events has an associated weight factor;\nidentifying, by the computer system, based on the event data, lateral movement candidate entities, wherein identifying the lateral movement candidate entities comprises, for each entity of the plurality of entities:\nidentifying a subset of the event data that is associated with the entity;\nobtaining, based on the data store access, a weight factor for each event of the subset of event data;\ncalculating an entity weight factor for the entity based on the weight factor for each event; and\nwhen the entity weight factor is above a threshold, identifying the entity as a lateral movement candidate entity;\ncreating, by the computer system, based on the event data, a graph data structure that is indicative of a sequence of events associated with the lateral movement candidate entities; and\nanalyzing, by the computer system, the graph data structure to identify a potential security threat by identifying a subset of the lateral movement candidate entities that are associated with a particular observed sequence of events in the plurality of observed sequences of events.\n20. A non-transitory machine-readable storage medium storing instructions which, when executed by at least one processor, cause the at least one processor to perform operations, comprising:\naccessing, by a computer system, event data indicative of events related to a plurality of entities associated with a network;\naccessing a data store that includes data associated with selected events, wherein the selected events are indicative of lateral movement, and wherein each of the selected events has an associated weight factor;\nidentifying, by the computer system, based on the event data, lateral movement candidate entities, wherein identifying the lateral movement candidate entities comprises, for each entity of the plurality of entities:\nidentifying a subset of the event data that is associated with the entity;\nobtaining, based on the data store access, a weight factor for each event of the subset of event data;\ncalculating an entity weight factor for the entity based on the weight factor for each event; and\nwhen the entity weight factor is above a threshold, identifying the entity as a lateral movement candidate entity;\ncreating, by the computer system, based on the event data, a graph data structure that is indicative of a sequence of events associated with the lateral movement candidate entities; and\nanalyzing, by the computer system, the graph data structure to identify a potential security threat by identifying a subset of the lateral movement candidate entities that are associated with a particular observed sequence of events in the plurality of observed sequences of events."
}