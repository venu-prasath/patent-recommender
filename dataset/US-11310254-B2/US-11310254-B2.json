{
    "patent_id": "US-11310254-B2",
    "title": "Network anomaly detection ",
    "assignee": "Palantir Technologies Inc.",
    "publication_date": "2022-04-19",
    "patent_link": "https://patents.google.com/patent/US11310254B2/en",
    "inventors": [
        "Maxim Kesin",
        "Samuel Jones"
    ],
    "classifications": [
        "H04L63/1425",
        "G06N7/005",
        "G06N7/01",
        "H04L61/2007",
        "H04L61/5007",
        "H04L63/083",
        "H04L63/12",
        "H04L63/1416",
        "H04L67/22",
        "H04L67/535",
        "H04L2463/143"
    ],
    "abstract": "A security system detects anomalous activity in a network. The system logs user activity, which can include ports used, compares users to find similar users, sorts similar users into cohorts, and compares new user activity to logged behavior of the cohort. The comparison can include a divergence calculation. Origins of user activity can also be used to determine anomalous network activity. The hostname, username, IP address, and timestamp can be used to calculate aggregate scores and convoluted scores.",
    "claims": "\n1. A computer system comprising:\none or more non-transitory computer readable storage mediums having program instructions embodied thereon; and\none or more processors configured to execute the program instructions to cause the computer system to:\nreceive network activity information associated with a plurality of users, wherein the network activity information includes at least indications of resources accessed by the plurality of users;\ndetermine, for each for the resources accessed, and based at least in part on the network activity information, respective inverse user frequency scale factors;\ncalculate similarity scores for the plurality of users based at least in part on the network activity information and the relevant inverse user frequency scale factors;\nsort the plurality of users into a plurality of cohorts based at least in part on the similarity scores;\nreceive new first network activity information associated with a first user of the plurality of users, wherein the first user is associated with a first cohort of the plurality of cohorts; and\ndetermine, based at least in part on a comparison between at least a portion of the first network activity information and network activity information associated with the first cohort, that the first network activity information associated with the first user is anomalous.\n2. The computer system of claim 1, wherein the one or more processors are further configured to execute the program instructions to further cause the computer system to:\nanalyze the network activity information to determine any distributed resources among the resources accessed by the plurality of users,\nwherein any multiple resources accessed that comprise a single distributed resources are considered a single resource accessed by the plurality of users for the purposes of determining inverse user frequency scale factors, determining similarity scores, and determining that new network activity is anomalous.\n3. The computer system of claim 1, wherein the respective inverse user frequency scale factors are calculated, for each respective resource accessed, by dividing the number of accesses by the number of users, and subtracting the result from one.\n4. The computer system of claim 1, wherein the respective inverse user frequency scale factors are calculated, for each respective resource accessed, by dividing the number of users by the number of accesses, and taking the log of the result.\n5. The computer system of claim 1, the similarity scores are calculated at least in part by determining at least one of: Jaccard similarity scores, or cosine similarity scores.\n6. The computer system of claim 1, wherein the one or more processors are further configured to execute the program instructions to further cause the computer system to:\ndetermine, based at least in part on a comparison between at least a portion of the first network activity information and previous network activity information associated with the first user, that the first network activity information associated with the first user is not anomalous.\n7. The computer system of claim 1, the plurality of users are sorted into the plurality of cohorts further based at least in part on user information associated with the users.\n8. A computer-implemented method comprising:\nby one or more processors executing program instructions:\nreceiving network activity information associated with a plurality of users, wherein the network activity information includes at least indications of resources accessed by the plurality of users;\ndetermining, for each for the resources accessed, and based at least in part on the network activity information, respective inverse user frequency scale factors;\ncalculating similarity scores for the plurality of users based at least in part on the network activity information and the relevant inverse user frequency scale factors;\nsorting the plurality of users into a plurality of cohorts based at least in part on the similarity scores;\nreceiving new first network activity information associated with a first user of the plurality of users, wherein the first user is associated with a first cohort of the plurality of cohorts; and\ndetermining, based at least in part on a comparison between at least a portion of the first network activity information and network activity information associated with the first cohort, that the first network activity information associated with the first user is anomalous.\n9. The computer-implemented method of claim 8 further comprising:\nby the one or more processors executing program instructions:\nanalyzing the network activity information to determine any distributed resources among the resources accessed by the plurality of users,\nwherein any multiple resources accessed that comprise a single distributed resources are considered a single resource accessed by the plurality of users for the purposes of determining inverse user frequency scale factors, determining similarity scores, and determining that new network activity is anomalous.\n10. The computer-implemented method of claim 8, wherein the respective inverse user frequency scale factors are calculated, for each respective resource accessed, by dividing the number of accesses by the number of users, and subtracting the result from one.\n11. The computer-implemented method of claim 8, wherein the respective inverse user frequency scale factors are calculated, for each respective resource accessed, by dividing the number of users by the number of accesses, and taking the log of the result.\n12. The computer-implemented method of claim 8, the similarity scores are calculated at least in part by determining at least one of: Jaccard similarity scores, or cosine similarity scores.\n13. The computer-implemented method of claim 8 further comprising:\nby the one or more processors executing program instructions:\ndetermining, based at least in part on a comparison between at least a portion of the first network activity information and previous network activity information associated with the first user, that the first network activity information associated with the first user is not anomalous.\n14. The computer-implemented method of claim 8, the plurality of users are sorted into the plurality of cohorts further based at least in part on user information associated with the users.\n15. A non-transitory computer readable storage medium storing computer executable instructions configured for execution by one or more hardware processors of a computer system to cause the computer system to:\nreceive network activity information associated with a plurality of users, wherein the network activity information includes at least indications of resources accessed by the plurality of users;\ndetermine, for each for the resources accessed, and based at least in part on the network activity information, respective inverse user frequency scale factors;\ncalculate similarity scores for the plurality of users based at least in part on the network activity information and the relevant inverse user frequency scale factors;\nsort the plurality of users into a plurality of cohorts based at least in part on the similarity scores;\nreceive new first network activity information associated with a first user of the plurality of users, wherein the first user is associated with a first cohort of the plurality of cohorts; and\ndetermine, based at least in part on a comparison between at least a portion of the first network activity information and network activity information associated with the first cohort, that the first network activity information associated with the first user is anomalous."
}