{
    "patent_id": "US-11763197-B2",
    "title": "Communication efficient federated learning ",
    "assignee": "Google Llc",
    "publication_date": "2023-09-19",
    "patent_link": "https://patents.google.com/patent/US11763197B2/en",
    "inventors": [
        "Hugh Brendan McMahan",
        "Dave Morris Bacon",
        "Jakub Konecny",
        "Xinnan Yu"
    ],
    "classifications": [
        "G06N20/00",
        "G06N3/08",
        "G06F17/16",
        "G06F17/18",
        "G06N3/045",
        "G06N7/01",
        "H04L67/01",
        "G06F7/582"
    ],
    "abstract": "The present disclosure provides efficient communication techniques for transmission of model updates within a machine learning framework, such as, for example, a federated learning framework in which a high-quality centralized model is trained on training data distributed overt a large number of clients each with unreliable network connections and low computational power. In an example federated learning setting, in each of a plurality of rounds, each client independently updates the model based on its local data and communicates the updated model back to the server, where all the client-side updates are used to update a global model. The present disclosure provides systems and methods that reduce communication costs. In particular, the present disclosure provides at least: structured update approaches in which the model update is restricted to be small and sketched update approaches in which the model update is compressed before sending to the server.",
    "claims": "\n1. A client computing device, comprising:\nat least one processor; and\nat least one non-transitory computer-readable medium that stores instructions that, when executed by the at least one processor, cause the client computing device to perform operations, the operations comprising:\nobtaining global values for a set of parameters of a machine-learned model;\ntraining the machine-learned model based at least in part on a local dataset to obtain an update matrix that is descriptive of updated values for the set of parameters of the machine-learned model, wherein the local dataset is stored locally by the client computing device;\nencoding the update matrix to obtain an encoded update, wherein encoding the update matrix comprises multiplying a vector of the update matrix by a rotation matrix to obtain a rotated update, and wherein the rotation matrix is a structured rotation matrix that does not require complete generation of the rotation matrix by the client computing device; and\ncommunicating the encoded update to a server computing device.\n2. The client computing device of claim 1, wherein encoding the update matrix comprises subsampling the update matrix to obtain the encoded update.\n3. The client computing device of claim 2, wherein subsampling the update matrix comprises:\ngenerating a parameter mask that specifies a portion of the set of parameters to be sampled; and\nsubsampling the update matrix according to the parameter mask.\n4. The client computing device of claim 3, wherein generating the parameter mask comprises generating the parameter mask based at least in part on a seed and a pseudorandom number generator, wherein both the client computing device and the server computing device have knowledge of the seed such that the parameter mask is reproducible by the server computing device.\n5. The client computing device of claim 1, wherein encoding the update matrix comprises probabilistically quantizing one or more values included in the update matrix.\n6. The client computing device of claim 1, wherein encoding the update matrix comprises performing probabilistic binary quantization for one or more values included in the update matrix to change each of the one or more values to a maximum value included in the update matrix or a minimum value included in the update matrix.\n7. The client computing device of claim 1, wherein encoding the update matrix comprises:\ndefining a plurality of intervals between a maximum value included in the update matrix and a minimum value included in the update matrix; and\nprobabilistically changing each of one or more values included in the update matrix to a local interval maximum or a local interval maximum.\n8. The client computing device of claim 1, wherein encoding the update matrix further comprises: probabilistically quantizing one or more values included in the rotated update.\n9. At least one non-transitory computer-readable medium that stores instructions that, when executed by a client computing device, cause the client computing device to perform operations, the operations comprising:\nobtaining global values for a set of parameters of a machine-learned model;\ntraining the machine-learned model based at least in part on a local dataset to obtain an update matrix that is descriptive of updated values for the set of parameters of the machine-learned model, wherein the local dataset is stored locally by the client computing device, and wherein the update matrix is restricted to be at least one of a low-rank matrix and a sparse matrix;\nencoding the update matrix to obtain an encoded update, wherein encoding the update matrix comprises multiplying a vector of the update matrix by a rotation matrix to obtain a rotated update, and wherein the rotation matrix is a structured rotation matrix that does not require complete generation of the rotation matrix by the client computing device; and\ncommunicating the encoded update to a server computing device.\n10. A computer-implemented method, comprising:\nobtaining, by a client computing device comprising one or more processors, global values for a set of parameters of a machine-learned model;\ntraining, by the client computing device, the machine-learned model based at least in part on a local dataset to obtain an update matrix that is descriptive of updated values for the set of parameters of the machine-learned model, wherein the local dataset is stored locally by the client computing device;\nencoding, by the client computing device, the update matrix to obtain an encoded update, wherein encoding the update matrix comprises multiplying a vector of the update matrix by a rotation matrix to obtain a rotated update, and wherein the rotation matrix is a structured rotation matrix that does not require complete generation of the rotation matrix by the client computing device; and\ncommunicating, by the client computing device, the encoded update to a server computing device.\n11. The method of claim 10, wherein encoding the update matrix comprises subsampling the update matrix to obtain the encoded update.\n12. The method of claim 11, wherein subsampling the update matrix comprises: generating, by the client computing device, a parameter mask that specifies a portion of the set of parameters to be sampled; and subsampling, by the client computing device, the update matrix according to the parameter mask.\n13. The method of claim 12, wherein generating the parameter mask comprises generating, by the client computing device, the parameter mask based at least in part on a seed and a pseudo-random number generator, wherein both the client computing device and the server computing device have knowledge of the seed such that the parameter mask is reproducible by the server computing device.\n14. The method of claim 10, wherein encoding the update matrix comprises probabilistically quantizing, by the client computing device, one or more values included in the update matrix.\n15. The method of claim 10, wherein encoding the update matrix comprises performing, by the client computing device, probabilistic binary quantization for one or more values included in the update matrix to change each of the one or more values to a maximum value included in the update matrix or a minimum value included in the update matrix.\n16. The method of claim 10, wherein encoding the update matrix comprises:\ndefining, by the client computing device, a plurality of intervals between a maximum value included in the update matrix and a minimum value included in the update matrix; and\nprobabilistically changing, by the client computing device, each of one or more values included in the update matrix to a local interval maximum or a local interval maximum.\n17. The method of claim 10, wherein encoding the update matrix further comprises: probabilistically quantizing, by the client computing device, one or more values included in the rotated update.",
    "status": "Active",
    "citations_own": [
        "CN1434406A",
        "US20030236662A1",
        "US6687653B1",
        "US6708163B1",
        "US6879944B1",
        "US20050138571A1",
        "US7016529B2",
        "US7069256B1",
        "US20060224579A1",
        "US20080209031A1",
        "US7664249B2",
        "US20100132044A1",
        "US20110085546A1",
        "US8018874B1",
        "US20120016816A1",
        "US8239396B2",
        "US20120226639A1",
        "US8321412B2",
        "US20120310870A1",
        "US8429103B1",
        "CN103093445A",
        "US20140214735A1",
        "US8954357B2",
        "US20150186798A1",
        "US20150193695A1",
        "US20150195144A1",
        "WO2015126858A1",
        "US20150324690A1",
        "US9190055B1",
        "US9275398B1",
        "CN105528620A",
        "US9336483B1",
        "US9390370B2",
        "US9400955B2",
        "US9424836B2",
        "US20180075347A1"
    ],
    "citations_ftf": [],
    "citedby_own": [
        "US20220124113A1"
    ],
    "citedby_ftf": [
        "US10769549B2",
        "US10902089B2",
        "CN108520303A",
        "WO2019219846A1",
        "US11593634B2",
        "CN110738323B",
        "CN109165515A",
        "CN109034398B",
        "CN109165725B",
        "CN109165683B",
        "CN109325584B",
        "CN109255444B",
        "CN109145984B",
        "US11455572B2",
        "CN109460826A",
        "CN111126613A",
        "CN109657055A",
        "US11562046B2",
        "US20210166157A1",
        "US11610110B2",
        "WO2020115273A1",
        "CN109711556B",
        "US11138327B2",
        "KR102247322B1",
        "CN109492420B",
        "SG11201910061RA",
        "CN111612153A",
        "EP3935581A4",
        "CN111680798A",
        "TWI744827B",
        "FR3094109A1",
        "WO2020210979A1",
        "CN113795850A",
        "EP3742669B1",
        "US11227187B1",
        "CN110288094B",
        "US11694110B2",
        "US11562228B2",
        "CN110263936B",
        "CN110348241B",
        "US11494671B2",
        "EP3767511B1",
        "KR20210015531A",
        "WO2021022717A1",
        "CN110472745B",
        "US10803184B2",
        "US20220294606A1",
        "EP4014434A1",
        "CN110380917B",
        "CN110503207A",
        "CN110674528A",
        "US20210089878A1",
        "CN110795477A",
        "CN110601814B",
        "US20210089922A1",
        "EP4042296A4",
        "US20230106985A1",
        "US20210125105A1",
        "CN110837527B",
        "CN110909865B",
        "CN110995793B",
        "US11461593B2",
        "CN110990870A",
        "US20230004776A1",
        "US11588621B2",
        "CN111062044B",
        "SE545545C2",
        "US11551083B2",
        "WO2021121585A1",
        "US20210216902A1",
        "WO2021144803A1",
        "CN110874650B",
        "WO2021149845A1",
        "GB2591496A",
        "US20230068386A1",
        "GB202001468D0",
        "CN111651263B",
        "CN111324813A",
        "CN111352799A",
        "EP4115360A4",
        "US20210287114A1",
        "CN113496291A",
        "CN113497785B",
        "US11438348B2",
        "KR102544531B1",
        "CN111538598A",
        "CN111553483A",
        "CN111553484B",
        "KR20210138994A",
        "CN112036580B",
        "US11755951B2",
        "WO2021247448A1",
        "US20210383197A1",
        "US11664033B2",
        "CN111678696A",
        "WO2021261611A1",
        "DE102020117638A1",
        "WO2022014732A1",
        "CN111898484A",
        "CN111856934B",
        "EP4182854A1",
        "CN113988254B",
        "CN111882133B",
        "US20220044117A1",
        "CN111967609B",
        "CN111970277B",
        "WO2022050729A1",
        "US11620583B2",
        "US20230325711A1",
        "US20220101204A1",
        "TWI775170B",
        "JP2022059756A",
        "CN112235062A",
        "CN112232519A",
        "CN112329947A",
        "CN112288101A",
        "EP4238357A1",
        "CN112418446A",
        "CN112464278B",
        "US20220180251A1",
        "CN112734050A",
        "CN112814854B",
        "CN112819177B",
        "US11017322B1",
        "WO2022162677A1",
        "US11711348B2",
        "CN112966832B",
        "CN113255928B",
        "EP4083838A1",
        "WO2022244903A1",
        "CN113361598B",
        "WO2022261353A1",
        "CN115526365A",
        "CN113537512A",
        "US11443245B1",
        "WO2023022251A1",
        "KR102358186B1",
        "WO2023113401A1",
        "DE102022000473A1"
    ]
}