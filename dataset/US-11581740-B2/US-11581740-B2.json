{
    "patent_id": "US-11581740-B2",
    "title": "Method, system and storage medium for load dispatch optimization for residential microgrid ",
    "assignee": "Hefei University Of Technology",
    "publication_date": "2023-02-14",
    "patent_link": "https://patents.google.com/patent/US11581740B2/en",
    "inventors": [
        "Kaile ZHOU",
        "Lulu WEN",
        "Shanlin YANG"
    ],
    "classifications": [
        "H02J3/00",
        "G06Q10/06315",
        "G06N3/006",
        "G06N3/044",
        "G06N3/0445",
        "G06N3/045",
        "G06N3/0454",
        "G06N3/082",
        "G06N3/084",
        "G06Q50/06",
        "H02J3/004",
        "H02J3/383",
        "H02J3/388",
        "H02J2203/10",
        "H02J2203/20",
        "H02J2300/24",
        "H02J3/003",
        "Y02E10/56",
        "Y02E60/00",
        "Y04S10/50",
        "Y04S40/20"
    ],
    "abstract": "The present invention provides a method, system and storage medium for load dispatch optimization for residential microgrid. The method includes collecting environmental data and time data of residential microgrid in preset future time period; obtaining power load data of residential microgrid in future time period by inputting environmental data and time data into pre-trained load forecasting model; obtaining photovoltaic output power data of residential microgrid in future time period by inputting environmental data and time data into pre-trained photovoltaic output power forecasting model; determining objective function and corresponding constraint condition of residential microgrid in future time period, where optimization objective of objective function is to minimize total cost of residential microgrid; obtaining load dispatch scheme of residential microgrid in future time period by solving objective function with particle swarm algorithm. The invention can provide load dispatch scheme suitable for current microgrid and reduce operating cost of residential microgrid.",
    "claims": "\n1. A computer-implemented load dispatch optimization method for a residential microgrid, the method comprising:\nS100, collecting environmental data and time data of the residential microgrid in a preset future time period;\nS200, obtaining power load data of the residential microgrid in the future time period by inputting the environmental data and the time data into a pre-trained load forecasting model; and obtaining photovoltaic output power data of the residential microgrid in the future time period by inputting the environmental data and the time data into a pre-trained photovoltaic output power forecasting model; wherein the load forecasting model and the photovoltaic output power forecasting model both comprise a gated recurrent unit (GRU)-based recurrent neural network;\nS300, determining an objective function and a constraint condition of the residential microgrid in the future time period according to the power load data and the photovoltaic output power data, wherein an optimization objective of the objective function is to minimize a total cost of the residential microgrid; and\nS400, obtaining a load dispatch scheme of the residential microgrid in the future time period by solving the objective function with a particle swarm algorithm.\n2. The method according to claim 1, wherein\na training process of the load forecasting model comprises:\nS001 a, obtaining first data in a first historical time period, each piece of the first data including residential load data, corresponding environmental data and corresponding time data;\nS002 a, dividing all the first data in the first historical time period into a first training set and a first test set, and performing normalization processing on the first training set and the first test set, wherein any time data in the first training set is earlier than any time data in the first test set;\nS003 a, setting the number of layers of gated recurrent unit (GRU) layers in a first recurrent neural network and the number of neurons in each GRU layer, the number of layers of hidden layers and the number of neurons in each hidden layer, and network related parameters;\nS004 a, inputting the first training set subjected to the normalization processing into the first recurrent neural network, and obtaining a load forecasting model by training with the Adam gradient descent algorithm;\nS005 a, inputting the environmental data and the time data in the first test set into the current load forecasting model to obtain the forecasted load data; and\nS006 a, obtaining a first evaluation result by evaluating forecasting capability of the current load forecasting model according to the forecasted load data and the corresponding power load data in the first test set; and determining whether the current load forecasting model satisfies a preset first forecasting accuracy requirement according to the first evaluation result, and if so, the current load forecasting model as the final load forecasting model is output; otherwise, the current load forecasting model is adjusted and the process returns to S003 a; and/or\na training process of the photovoltaic output power forecasting model comprises:\nS001 b, obtaining second data in a second historical time period, each of the second data includes photovoltaic output power data, corresponding environmental data and corresponding time data;\nS002 b, dividing the second historical time period into a second training set and a second test set, and performing normalization processing on the second training set and the second test set, wherein any time data in the second training set is earlier than any time data in the second test set;\nS003 b, setting the number of layers of gated recurrent unit (GRU) layers in a second recurrent neural network and the number of neurons in each GRU layer, the number of layers of hidden layers and the number of neurons in each hidden layer, and network related parameters;\nS004 b, inputting the second training set subjected to the normalization processing into the second recurrent neural network, and obtaining a photovoltaic output power forecasting model by training with the Adam gradient descent algorithm;\nS005 b, inputting the environmental data and the time data in the second test set into the current photovoltaic output power forecasting model to obtain the forecasted photovoltaic output power data; and\nS006 b, obtaining a second evaluation result by evaluating forecasting capability of the current photovoltaic output power forecasting model according to the forecasted photovoltaic output power data and the corresponding photovoltaic output power data in the second test set; and determining whether the current photovoltaic output power forecasting model satisfies a preset second forecasting accuracy requirement according to the second evaluation result, and if so, the current photovoltaic output power forecasting model as the final photovoltaic output power forecasting model is output; otherwise, the current photovoltaic output power forecasting model is adjusted and the process returns to S003 b.\n3. The method according to claim 2, wherein the first training set and the first test set are represented in a matrix form, wherein each row in the matrix includes power load data, environmental data and time data, and data in the same column in the matrix has the same meaning; the second training set and the second test set are represented in a matrix form, wherein each row in the matrix includes photovoltaic output power data, environmental data and time data, and data in the same column in the matrices has the same meaning;\ncorrespondingly, the first training set, the first test set, the second training set and the second test set are normalized with a first formula which comprises:\n4. The method according to claim 3, wherein the objective function comprises:\n\nC=C 1 +C 2 +C 3 +C 4\nwherein C is the total cost in the residential microgrid, C1 is the cost of electricity purchased and sold in the residential microgrid, C2 is the depreciation cost of electric vehicle batteries in the residential microgrid, C3 is the depreciation cost of energy storage units in the residential microgrid, and C4 is the environment cost in the residential microgrid;\nwherein the calculation formula for the cost of electricity purchased and sold comprises:\n5. The method according to claim 4, wherein the constraint condition comprises at least one of: a supply and demand balance constraint condition of the residential microgrid, a charging constraint condition of electric vehicle and energy storage unit in the residential microgrid, a charge and discharge power constraint condition of electric vehicle and energy storage unit in the residential microgrids, a charge amount constraint condition of electric vehicle in the residential microgrid and a transmission power constraint condition between the residential microgrid and the main grid; wherein:\nthe supply and demand balance constraint condition comprises:\n\nP\u2032+P pv +P EVs +P ESS =P load\nwherein P\u2032 represents transmission power between the main grid and the residential microgrid, Ppv represents output power of solar energy, PEVs represents output power of electric vehicles in the residential microgrid, PESS represents output power of all energy storage units in the residential microgrid, and Pload represents total load of the resident microgrid;\nthe charging constraint comprises:\n\nSC 1i min \u2264SC 1i \u2264SC 1i max ,SC 2j min \u2264SC 2j \u2264SC 2j max\nwherein sc1i, represents amount of charge of the i-th electric vehicle in the residential microgrid, SC2j, represents amount of charge of the j-th energy storage unit in the residential microgrid, SC1i min is a lower limit value of a state of charge of the i-th electric vehicle, SC2j min is a lower limit value of a state of charge of the j-th energy storage unit, SC1i max is a upper limit value of the state of charge of the i-th electric vehicle, and SC2j max is a upper limit value of the state of charge of the j-th energy storage unit;\nthe charge and discharge power constraint condition comprises:\n\nP 1i min \u2264P i EV \u2264P 1i max ,P 2j min P j ESS \u2264P 2j max\nPi EV is the charge and discharge power of the i-th electric vehicle in the residential microgrid, Pj ESS is the charge and discharge power of the j-th energy storage unit in the residential microgrid, P1i min is a lower limit of the charge and discharge power of the i-th electric vehicle, P2j min is a lower limit of the charge and discharge power of the j-th energy storage unit, P1j max is a upper limit of the charge and discharge power of the i-th electric vehicle, and P2j max is a upper limit of the charge and discharge power of the j-th energy storage unit;\nthe charge amount constraint condition comprises:\n\nSC t i\u2265SC t i min\nwherein Sct j represents amount of charge when the i-th electric vehicle in the residential microgrid leaves the residential microgrid, and SCt j min represents the minimum of charge required by the i-th electric vehicle traveling;\nthe transmission power constraint condition comprises:\n\n\u2212P max \u2264P\u2032\u2264P max\nwherein P\u2032 represents the transmission power between the residential microgrid and the main grid, and Pmax represents the maximum transmission power between the residential microgrid and the main grid.\n6. The method according to claim 2, wherein the objective function comprises:\n\nC=C 1 +C 2 +C 3 +C 4\nwherein C is the total cost in the residential microgrid, C1 is the cost of electricity purchased and sold in the residential microgrid, C2 is the depreciation cost of electric vehicle batteries in the residential microgrid, C3 is the depreciation cost of energy storage units in the residential microgrid, and C4 is the environment cost in the residential microgrid;\nwherein the calculation formula for the cost of electricity purchased and sold comprises:\n7. The method according to claim 6, wherein the constraint condition comprises at least one of: a supply and demand balance constraint condition of the residential microgrid, a charging constraint condition of electric vehicle and energy storage unit in the residential microgrid, a charge and discharge power constraint condition of electric vehicle and energy storage unit in the residential microgrids, a charge amount constraint condition of electric vehicle in the residential microgrid and a transmission power constraint condition between the residential microgrid and the main grid; wherein:\nthe supply and demand balance constraint condition comprises:\n\nP\u2032+P pv +P EVs +P ESS =P load\nwherein P\u2032 represents transmission power between the main grid and the residential microgrid, Ppv represents output power of solar energy, PEvs represents output power of electric vehicles in the residential microgrid, PESS represents output power of all energy storage units in the residential microgrid, and Pload represents total load of the resident microgrid;\nthe charging constraint comprises:\n\nSC 1i min \u2264SC 1i \u2264SC 1i max ,SC 2j min \u2264SC 2j \u2264SC 2j max\nwherein SC1j, represents amount of charge of the i-th electric vehicle in the residential microgrid, SC2j, represents amount of charge of the j-th energy storage unit in the residential microgrid, SC1i min is a lower limit value of a state of charge of the i-th electric vehicle, SC2j min is a lower limit value of a state of charge of the j-th energy storage unit, SC1i max is a upper limit value of the state of charge of the i-th electric vehicle, and SC2j max is a upper limit value of the state of charge of the j-th energy storage unit;\nthe charge and discharge power constraint condition comprises:\n\nP 1i min \u2264P i EV \u2264P 1i max ,P 2j min P j ESS \u2264P 2j max\nPi EV is the charge and discharge power of the i-th electric vehicle in the residential microgrid, Pj ESS is the charge and discharge power of the j-th energy storage unit in the residential microgrid, P1i min is a lower limit of the charge and discharge power of the i-th electric vehicle, P2j min is a lower limit of the charge and discharge power of the j-th energy storage unit, P1j max is a upper limit of the charge and discharge power of the i-th electric vehicle, and P2j max is a upper limit of the charge and discharge power of the j-th energy storage unit;\nthe charge amount constraint condition comprises:\n\nSC t i\u2265SC t i min\nwherein SCt i represents amount of charge when the i-th electric vehicle in the residential microgrid leaves the residential microgrid, and SCt i min represents the minimum of charge required by the i-th electric vehicle traveling;\nthe transmission power constraint condition comprises:\n\n\u2212P max \u2264P\u2032\u2264P max\nwherein P\u2032 represents the transmission power between the residential microgrid and the main grid, and Pmax represents the maximum transmission power between the residential microgrid and the main grid.\n8. The method according to claim 1, wherein the objective function comprises:\n\nC=C 1 +C 2 +C 3 +C 4\nwherein C is the total cost in the residential microgrid, C1 is the cost of electricity purchased and sold in the residential microgrid, C2 is the depreciation cost of electric vehicle batteries in the residential microgrid, C3 is the depreciation cost of energy storage units in the residential microgrid, and C4 is the environment cost in the residential microgrid;\nwherein the calculation formula for the cost of electricity purchased and sold comprises:\nwherein P(t) represents the transmission value of amount of power between a main grid and the residential microgrid, St represents the electricity price of time period t, and T is the future time period;\nthe calculation formula for the depreciation cost of electric vehicle batteries comprises:\n9. The method according to claim 8, wherein the constraint condition comprises at least one of: a supply and demand balance constraint condition of the residential microgrid, a charging constraint condition of electric vehicle and energy storage unit in the residential microgrid, a charge and discharge power constraint condition of electric vehicle and energy storage unit in the residential microgrids, a charge amount constraint condition of electric vehicle in the residential microgrid and a transmission power constraint condition between the residential microgrid and the main grid; wherein:\nthe supply and demand balance constraint condition comprises:\n\nP\u2032+P pv +P EVs +P ESS =P load\nwherein P\u2032 represents transmission power between the main grid and the residential microgrid, Ppv represents output power of solar energy, PEVs represents output power of electric vehicles in the residential microgrid, PESS represents output power of all energy storage units in the residential microgrid, and Pload represents total load of the resident microgrid;\nthe charging constraint comprises:\n\nSC 1i min \u2264SC 1i \u2264SC 1i max ,SC 2j min \u2264SC 2j \u2264SC 2j max\nwherein SC1j, represents amount of charge of the i-th electric vehicle in the residential microgrid, SC2j, represents amount of charge of the j-th energy storage unit in the residential microgrid, SC1i min is a lower limit value of a state of charge of the i-th electric vehicle, SC2j min is a lower limit value of a state of charge of the j-th energy storage unit, SC1i max is a upper limit value of the state of charge of the i-th electric vehicle, and SC2j max is a upper limit value of the state of charge of the j-th energy storage unit;\nthe charge and discharge power constraint condition comprises:\n\nP 1i min \u2264P i EV \u2264P 1i max ,P 2j min P j ESS \u2264P 2j max\npi EV is the charge and discharge power of the i-th electric vehicle in the residential microgrid, P j ESS is the charge and discharge power of the j-th energy storage unit in the residential microgrid, P1i min is a lower limit of the charge and discharge power of the i-th electric vehicle, P2j min is a lower limit of the charge and discharge power of the j-th energy storage unit, P1j max is a upper limit of the charge and discharge power of the i-th electric vehicle, and P2j max is a upper limit of the charge and discharge power of the j-th energy storage unit;\nthe charge amount constraint condition comprises:\n\nSC t i\u2265SC t i min\nwherein SCt i , represents amount of charge when the i-th electric vehicle in the residential microgrid leaves the residential microgrid, and SCt 1 min represents the minimum of charge required by the i-th electric vehicle traveling;\nthe transmission power constraint condition comprises:\n\n\u2212P max \u2264P\u2032\u2264P max\nwherein P\u2032 represents the transmission power between the residential microgrid and the main grid, and Pmax represents the maximum transmission power between the residential microgrid and the main grid.\n10. A computer readable storage medium having stored thereon a computer program, the computer program when executed by a processor implementing the method according to claim 1.\n11. A load dispatch optimization system for a residential microgrid, the system comprising a computer;\nwherein the computer comprises:\nat least one storage unit; and\nat least one processing unit;\nwherein at least one instruction is stored in the at least one storage unit, and the at least one instruction is loaded and executed by the at least one processing unit to perform steps of:\nS100, collecting environmental data and time data of the residential microgrid in a preset future time period;\nS200, obtaining power load data of the residential microgrid in the future time period by inputting the environmental data and the time data into a pre-trained load forecasting model; and obtaining photovoltaic output power data of the residential microgrid in the future time period by inputting the environmental data and the time data into a pre-trained photovoltaic output power forecasting model; wherein the load forecasting model and the photovoltaic output power forecasting model both comprise a GRU-based recurrent neural network;\nS300, determining an objective function and a constraint condition of the residential microgrid in the future time period according to the power load data and the photovoltaic output power data, wherein the optimization objective of the objective function is to minimize the total cost of the residential microgrid; and\nS400, obtaining a load dispatch scheme of the residential microgrid in the future time period by solving the objective function with a particle swarm algorithm."
}