{
    "patent_id": "US-10911470-B2",
    "title": "Detecting anomalies in a computer network based on usage similarity scores ",
    "assignee": "Splunk Inc.",
    "publication_date": "2021-02-02",
    "patent_link": "https://patents.google.com/patent/US10911470B2/en",
    "inventors": [
        "Sudhakar Muddu",
        "Christos Tryfonas",
        "Fumei Lam",
        "Georgios Apostolopoulos"
    ],
    "classifications": [
        "G06N20/20",
        "G06F16/24578",
        "G06F16/254",
        "G06F16/285",
        "G06F16/444",
        "G06F16/9024",
        "G06F3/0482",
        "G06F3/0484",
        "G06F3/04842",
        "G06F3/04847",
        "G06F40/134",
        "G06K9/2063",
        "G06N20/00",
        "G06N5/022",
        "G06N5/04",
        "G06N7/005",
        "G06N7/01",
        "G06V10/225",
        "H04L41/0893",
        "H04L41/145",
        "H04L41/22",
        "H04L43/00",
        "H04L43/045",
        "H04L43/062",
        "H04L43/08",
        "H04L63/06",
        "H04L63/1408",
        "H04L63/1416",
        "H04L63/1425",
        "H04L63/1433",
        "H04L63/1441",
        "H04L63/20",
        "H05K999/99",
        "H04L2463/121"
    ],
    "abstract": "A security platform employs a variety techniques and mechanisms to detect security related anomalies and threats in a computer network environment. The security platform is \u201cbig data\u201d driven and employs machine learning to perform security analytics. The security platform performs user/entity behavioral analytics (UEBA) to detect the security related anomalies and threats, regardless of whether such anomalies/threats were previously known. The security platform can include both real-time and batch paths/modes for detecting anomalies and threats. By visually presenting analytical results scored with risk ratings and supporting evidence, the security platform enables network security administrators to respond to a detected anomaly or threat, and to take action promptly.",
    "claims": "1. A method comprising:\naccessing, by a computer system, usage similarity scores for a plurality of network devices associated with a computer network, the usage similarity scores being indicative of which of the network devices have been shared by a user or by a group of users who satisfy a similarity criterion;\naccessing, by the computer system, data indicative of computer network activity of a particular user of a plurality of users; and\ndetecting, by the computer system, in response to accessing the data, an anomaly indicative that the particular user has interacted with a particular network device with which the particular user does not normally interact, based on the usage similarity scores.accessing, by a computer system, usage similarity scores for a plurality of network devices associated with a computer network, the usage similarity scores being indicative of which of the network devices have been shared by a user or by a group of users who satisfy a similarity criterion;accessing, by the computer system, data indicative of computer network activity of a particular user of a plurality of users; anddetecting, by the computer system, in response to accessing the data, an anomaly indicative that the particular user has interacted with a particular network device with which the particular user does not normally interact, based on the usage similarity scores.2. The method of claim 1, further comprising:\nretrieving a graph data structure that records anomalies in the computer network and relationships between the anomalies and the users and network devices;\nidentifying a security threat based on the detected anomaly by identifying, in the graph data structure, a relationship path in the data structure from the particular user to a network device designated as a critical resource of the computer network, the relationship path including users and network devices interlinked by anomalies; and\nreporting the security threat to an administrator of the computer network.retrieving a graph data structure that records anomalies in the computer network and relationships between the anomalies and the users and network devices;identifying a security threat based on the detected anomaly by identifying, in the graph data structure, a relationship path in the data structure from the particular user to a network device designated as a critical resource of the computer network, the relationship path including users and network devices interlinked by anomalies; andreporting the security threat to an administrator of the computer network.3. The method of claim 1, further comprising:\nretrieving a graph data structure that records anomalies in a computer network and relationships between the anomalies and the users and network devices, the graph data structure including nodes interconnected by edges, the nodes representing the entities, the edges representing usage relationships between the entities;\nidentifying a security threat based on the detected anomaly by identifying, in the graph data structure, a relationship path from the particular user through one or more anomalies in the data structure to a network device designated as a critical resource of the computer network; and\nreporting the security threat to an administrator of the computer network.retrieving a graph data structure that records anomalies in a computer network and relationships between the anomalies and the users and network devices, the graph data structure including nodes interconnected by edges, the nodes representing the entities, the edges representing usage relationships between the entities;identifying a security threat based on the detected anomaly by identifying, in the graph data structure, a relationship path from the particular user through one or more anomalies in the data structure to a network device designated as a critical resource of the computer network; andreporting the security threat to an administrator of the computer network.4. The method of claim 1, further comprising:\ndetermining that the detected anomaly is indicative of a suspicious lateral movement of the particular user in the computer network.determining that the detected anomaly is indicative of a suspicious lateral movement of the particular user in the computer network.5. The method of claim 1, wherein the usage similarity scores are based on login events indicative of the users logging into the network devices.6. The method of claim 1, wherein the usage similarity scores are assigned such that any first set of network devices that are accessed by the same or similar group of users are assigned usage similarity scores that are closer in value to each other than usage similarity scores of any second set of network devices that are not accessed by the same or similar group of users.7. The method of claim 1, further comprising:\nassigning usage similarity scores to the network devices based on login events indicative of users accessing the network devices, such that a first group of network devices that have similar groups of login users have usage similarity scores that are closer in value to each other than usage similarity scores of network devices that do not have similar groups of login users.assigning usage similarity scores to the network devices based on login events indicative of users accessing the network devices, such that a first group of network devices that have similar groups of login users have usage similarity scores that are closer in value to each other than usage similarity scores of network devices that do not have similar groups of login users.8. The method of claim 1, wherein the anomaly is detected in response to detecting that a particular user has interacted with a particular network device when a usage similarity score of the particular network device fails to satisfy a closeness criterion relative to usage similarity scores of network devices with which the particular user usually interacts.9. The method of claim 1, wherein detecting the anomaly is further based on classification metadata for the particular user indicative of the particular user being at least one of a regular user, an administrative user, or an automated user.10. The method of claim 1, wherein detecting the anomaly is further based on classification metadata for the particular network device indicative of the particular network device being at least one of a workstation, a server, or a printer.11. The method of claim 1, further comprising:\nidentifying usage relationships between the plurality of users and the plurality of network devices;\nwherein the usage relationships between the plurality of users and the plurality of network devices form a bipartite graph including a first set of the plurality of users and a second set of the plurality of network devices; and\nassigning usage similarity scores for the plurality of network devices based on the identified usage relationships.identifying usage relationships between the plurality of users and the plurality of network devices;wherein the usage relationships between the plurality of users and the plurality of network devices form a bipartite graph including a first set of the plurality of users and a second set of the plurality of network devices; andassigning usage similarity scores for the plurality of network devices based on the identified usage relationships.12. The method of claim 1, further comprising:\nidentifying usage relationships between the plurality of users and the plurality of network devices;\nwherein the usage relationships between the plurality of users and the plurality of network devices represent a time series of events in which the plurality of users have interacted with the plurality of network devices; and\nassigning usage similarity scores for the plurality of network devices based on the identified usage relationships.identifying usage relationships between the plurality of users and the plurality of network devices;wherein the usage relationships between the plurality of users and the plurality of network devices represent a time series of events in which the plurality of users have interacted with the plurality of network devices; andassigning usage similarity scores for the plurality of network devices based on the identified usage relationships.13. The method of claim 1, further comprising:\nforming a graph having nodes representing the plurality users and the plurality of network devices and edges representing usage relationships between the plurality of users and the plurality of network devices;\ndistributing weight values with a probability percentage along edges between nodes representing the plurality of users and the plurality network devices; and\nrepeating the distributing along edges until the weight values at nodes representing the plurality of network devices converge; and\nassigning usage similarity scores to the plurality network devices based on the converged weight values.forming a graph having nodes representing the plurality users and the plurality of network devices and edges representing usage relationships between the plurality of users and the plurality of network devices;distributing weight values with a probability percentage along edges between nodes representing the plurality of users and the plurality network devices; andrepeating the distributing along edges until the weight values at nodes representing the plurality of network devices converge; andassigning usage similarity scores to the plurality network devices based on the converged weight values.14. The method of claim 1, further comprising:\nforming a bipartite graph having nodes representing the plurality users and the plurality of network devices and edges representing usage relationships between the plurality of users and the plurality of network devices;\nassigning an initial weight value to a node of the bipartite graph;\nkeeping a percentage of the initial weight value at the node and equally distributing a remainder of the initial weight value from the node along edges of the node to other nodes;\nat each node, repeating a process until a weight value at each node converges, the process including:\nsumming weight values at each node of the bipartite graph, and\nkeeping the percentage of a previously distributed weight value at the node and equally distributing a remainder of the weight value from the node along edges of the node to other nodes; and\nassigning usage similarity scores to the plurality of network devices based on the converged weight values at the nodes representing the plurality of network devices.forming a bipartite graph having nodes representing the plurality users and the plurality of network devices and edges representing usage relationships between the plurality of users and the plurality of network devices;assigning an initial weight value to a node of the bipartite graph;keeping a percentage of the initial weight value at the node and equally distributing a remainder of the initial weight value from the node along edges of the node to other nodes;at each node, repeating a process until a weight value at each node converges, the process including:\nsumming weight values at each node of the bipartite graph, and\nkeeping the percentage of a previously distributed weight value at the node and equally distributing a remainder of the weight value from the node along edges of the node to other nodes; andsumming weight values at each node of the bipartite graph, andkeeping the percentage of a previously distributed weight value at the node and equally distributing a remainder of the weight value from the node along edges of the node to other nodes; andassigning usage similarity scores to the plurality of network devices based on the converged weight values at the nodes representing the plurality of network devices.15. The method of claim 1, further comprising:\nassigning usage similarity scores to the plurality of network devices based on usage relationships between the plurality of users and the plurality of network devices, such that particular network devices having multiple exclusive users interacting with only the particular network devices tend to have usage similarity scores that have differences less than a threshold value.assigning usage similarity scores to the plurality of network devices based on usage relationships between the plurality of users and the plurality of network devices, such that particular network devices having multiple exclusive users interacting with only the particular network devices tend to have usage similarity scores that have differences less than a threshold value.16. The method of claim 1, further comprising:\nassigning usage similarity scores to the plurality of network devices based on usage relationships between the plurality of users and the plurality of network devices, such that particular network devices having only a single shared user interacting with all of the particular network devices have different usage similarity scores.assigning usage similarity scores to the plurality of network devices based on usage relationships between the plurality of users and the plurality of network devices, such that particular network devices having only a single shared user interacting with all of the particular network devices have different usage similarity scores.17. The method of claim 1, wherein detecting the anomaly comprises:\ndetecting that the particular user has interacted with the particular network device;\ncalculating an anomaly score for the particular user based on a difference between a usage similarity score of the particular network device and a statistical measure of usage similarity scores of other network devices with which the user has interacted; and\ndetecting the anomaly in response to detecting that the anomaly score exceeds an anomaly threshold value.detecting that the particular user has interacted with the particular network device;calculating an anomaly score for the particular user based on a difference between a usage similarity score of the particular network device and a statistical measure of usage similarity scores of other network devices with which the user has interacted; anddetecting the anomaly in response to detecting that the anomaly score exceeds an anomaly threshold value.18. The method of claim 1, wherein detecting the anomaly comprises:\ndetermining an access profile of the particular user including network devices with which the particular user interacts and that have usage similarity scores that satisfy a closeness criterion;\nin response to the particular user interacting with the particular network device, calculating an anomaly score for the particular user based on a difference between a usage similarity score of the particular network device and an average of usage similarity scores of network devices in the access profile of the particular user; and\ndetecting the anomaly in response to detecting that the usage similarity score difference indicates that the particular user has interacted with the particular network device outside of the access profile of the particular user.determining an access profile of the particular user including network devices with which the particular user interacts and that have usage similarity scores that satisfy a closeness criterion;in response to the particular user interacting with the particular network device, calculating an anomaly score for the particular user based on a difference between a usage similarity score of the particular network device and an average of usage similarity scores of network devices in the access profile of the particular user; anddetecting the anomaly in response to detecting that the usage similarity score difference indicates that the particular user has interacted with the particular network device outside of the access profile of the particular user.19. The method of claim 1, wherein detecting the anomaly comprises:\ndetermining an access profile of the particular user, the access profile including network devices with which the particular user interacts and that have usage similarity scores that satisfy a closeness criterion; and\nwherein the access profile of the particular user further includes information of events indicative that the particular user has logged into a network device, validated credential of a network device, or accessed a network object stored on a network device.determining an access profile of the particular user, the access profile including network devices with which the particular user interacts and that have usage similarity scores that satisfy a closeness criterion; andwherein the access profile of the particular user further includes information of events indicative that the particular user has logged into a network device, validated credential of a network device, or accessed a network object stored on a network device.20. The method of claim 1, wherein detecting the anomaly comprises:\ndetermining an access profile of the particular user, the access profile including network devices with which the particular user interacts and that have usage similarity scores that satisfy a closeness criterion; and\nwherein the access profile of the particular user further includes information of events indicative that the particular user has succeeded logging in to a network device, failed logging in to a network device, succeeded validating credential of a network device, failed validating credential of a network device, succeeded accessing a network object stored on a network device, or failed accessing a network object stored on a network device.determining an access profile of the particular user, the access profile including network devices with which the particular user interacts and that have usage similarity scores that satisfy a closeness criterion; andwherein the access profile of the particular user further includes information of events indicative that the particular user has succeeded logging in to a network device, failed logging in to a network device, succeeded validating credential of a network device, failed validating credential of a network device, succeeded accessing a network object stored on a network device, or failed accessing a network object stored on a network device.21. The method of claim 1, wherein detecting the anomaly comprises:\nidentifying a first group of the plurality of network devices with which the particular user interacts and that have usage similarity scores that satisfy a closeness criterion;\nidentifying a second group of the plurality of network devices with which the particular user interacts; and\ndetecting an out-of-profile anomaly in response to determining that the particular user is the only user of the plurality of users who has interacted with both the first and second groups of the plurality of network devices.identifying a first group of the plurality of network devices with which the particular user interacts and that have usage similarity scores that satisfy a closeness criterion;identifying a second group of the plurality of network devices with which the particular user interacts; anddetecting an out-of-profile anomaly in response to determining that the particular user is the only user of the plurality of users who has interacted with both the first and second groups of the plurality of network devices.22. The method of claim 1, further comprising:\nidentifying a security threat based on the detected anomaly by identifying a relationship path from the particular user through one or more anomalies to a network device designated as a critical resource of the computer network, the critical resource being a server responsible for handling security authentication requests for the computer network.identifying a security threat based on the detected anomaly by identifying a relationship path from the particular user through one or more anomalies to a network device designated as a critical resource of the computer network, the critical resource being a server responsible for handling security authentication requests for the computer network.23. The method of claim 1, further comprising:\nidentifying a security threat based on the detected anomaly by identifying a relationship path from the particular user through one or more anomalies to a network device designated as a critical resource of the computer network, the security threat indicative that an unauthorized user has misappropriated a credential of the particular user to enter the computer network and breached one or more network devices along the relationship path to access the critical resource.identifying a security threat based on the detected anomaly by identifying a relationship path from the particular user through one or more anomalies to a network device designated as a critical resource of the computer network, the security threat indicative that an unauthorized user has misappropriated a credential of the particular user to enter the computer network and breached one or more network devices along the relationship path to access the critical resource.24. The method of claim 1, wherein the data indicative of computer network activity of the particular user includes machine data.25. The method of claim 1, wherein the data indicative of computer network activity of the particular user includes timestamped machine data.26. The method of claim 1, wherein the usage similarity scores are assigned to the plurality of network devices using a machine learning model.27. The method of claim 1, wherein detecting the anomaly is performed in real time as the data indicative of computer network activity of the particular user are received.28. The method of claim 1, wherein detecting the anomaly is performed in batch mode based on the data indicative of computer network activity of the particular user being retrieved from a persistent storage facility.29. A computing device comprising:\na processor; and\na memory storing instructions, execution of which by the processor will cause the computing device to perform a process including:\naccessing usage similarity scores for a plurality of network devices associated with a computer network, the usage similarity scores being indicative of which of the network devices have been shared by a user or by a group of users who satisfy a similarity criterion;\naccessing data indicative of computer network activity of a particular user of a plurality of users; and\ndetecting, in response to accessing the data, an anomaly indicative that the particular user has interacted with a particular network device with which the particular user does not normally interact, based on the usage similarity scores.a processor; anda memory storing instructions, execution of which by the processor will cause the computing device to perform a process including:\naccessing usage similarity scores for a plurality of network devices associated with a computer network, the usage similarity scores being indicative of which of the network devices have been shared by a user or by a group of users who satisfy a similarity criterion;\naccessing data indicative of computer network activity of a particular user of a plurality of users; and\ndetecting, in response to accessing the data, an anomaly indicative that the particular user has interacted with a particular network device with which the particular user does not normally interact, based on the usage similarity scores.accessing usage similarity scores for a plurality of network devices associated with a computer network, the usage similarity scores being indicative of which of the network devices have been shared by a user or by a group of users who satisfy a similarity criterion;accessing data indicative of computer network activity of a particular user of a plurality of users; anddetecting, in response to accessing the data, an anomaly indicative that the particular user has interacted with a particular network device with which the particular user does not normally interact, based on the usage similarity scores.30. A non-transitory machine-readable storage medium storing instructions, execution of which in a machine will cause the machine to perform a process including:\naccessing usage similarity scores for a plurality of network devices associated with a computer network, the usage similarity scores being indicative of which of the network devices have been shared by a user or by a group of users who satisfy a similarity criterion;\naccessing data indicative of computer network activity of a particular user of a plurality of users; and\ndetecting, in response to accessing the data, an anomaly indicative that the particular user has interacted with a particular network device with which the particular user does not normally interact, based on the usage similarity scores.accessing usage similarity scores for a plurality of network devices associated with a computer network, the usage similarity scores being indicative of which of the network devices have been shared by a user or by a group of users who satisfy a similarity criterion;accessing data indicative of computer network activity of a particular user of a plurality of users; anddetecting, in response to accessing the data, an anomaly indicative that the particular user has interacted with a particular network device with which the particular user does not normally interact, based on the usage similarity scores."
}