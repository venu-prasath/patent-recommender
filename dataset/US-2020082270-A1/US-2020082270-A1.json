{
    "patent_id": "US-2020082270-A1",
    "title": "Verifiable Deep Learning Training Service ",
    "assignee": "International Business Machines Corporation",
    "publication_date": "2020-03-12",
    "patent_link": "https://patents.google.com/patent/US20200082270A1/en",
    "inventors": [
        "Zhongshu Gu",
        "Heqing Huang",
        "Jialong Zhang",
        "Dong Su",
        "Dimitrios Pendarakis",
        "Ian M. Molloy"
    ],
    "classifications": [
        "G06N3/084",
        "G06F21/606",
        "G06F21/602",
        "G06F21/71",
        "G06N3/042",
        "G06N3/045",
        "G06N5/022",
        "G06N5/041",
        "G06N5/045"
    ],
    "abstract": "Deep learning training service framework mechanisms are provided. The mechanisms receive encrypted training datasets for training a deep learning model, execute a FrontNet subnet model of the deep learning model in a trusted execution environment, and execute a BackNet subnet model of the deep learning model external to the trusted execution environment. The mechanisms decrypt, within the trusted execution environment, the encrypted training datasets and train the FrontNet subnet model and BackNet subnet model of the deep learning model based on the decrypted training datasets. The FrontNet subnet model is trained within the trusted execution environment and provides intermediate representations to the BackNet subnet model which is trained external to the trusted execution environment using the intermediate representations. The mechanisms release a trained deep learning model comprising a trained FrontNet subnet model and a trained BackNet subnet model, to the one or more client computing devices.",
    "claims": "\n1. A method, in a data processing system comprising at least one processor and at least one memory, the at least one memory comprising instructions that are executed by the at least one processor to configure the at least one processor to implement a deep learning training service framework, the method comprising:\nreceiving, by the deep learning training service framework, from one or more client computing devices, one or more encrypted training datasets for training a deep learning model;\nexecuting, by the deep learning training service framework, a FrontNet subnet model of the deep learning model in a trusted execution environment of the deep learning training service framework;\nexecuting, by the deep learning training service framework, a BackNet subnet model of the deep learning model in the deep learning training service framework external to the trusted execution environment;\ndecrypting, by a security module executing within the trusted execution environment, the one or more encrypted training datasets;\ntraining, by training logic of the deep learning training service framework, the FrontNet subnet model and BackNet subnet model of the deep learning model based on the decrypted training datasets, wherein the FrontNet subnet model is trained within the trusted execution environment and provides intermediate representations to the BackNet subnet model which is trained external to the trusted execution environment using the intermediate representations; and\nreleasing, by the deep learning training service framework, a trained deep learning model comprising a trained FrontNet subnet model and a trained BackNet subnet model, to the one or more client computing devices.\n2. The method of claim 1, wherein the one or more client computing devices comprises a plurality of computing devices associated with a plurality of different training dataset providers, and wherein the security module executing within the trusted execution environment prevents training dataset providers from accessing training datasets provided by other training dataset providers.\n3. The method of claim 2, wherein each of the training datasets provided by the different training dataset providers are used during the training of the FrontNet subnet model and the BackNet subnet model of the deep learning model to generate the trained deep learning model, and wherein the same trained deep learning model is released to each of the different training dataset providers.\n4. The method of claim 1, further comprising:\nprior to decrypting the one or more encrypted training datasets, authenticating, by the security module, training dataset providers of the one or more training dataset providers; and\ndiscarding, by the security module, any training datasets from training dataset providers that do not pass the authentication from further use during training of the FrontNet subnet model and BackNet subnet model of the deep learning model.\n5. The method of claim 4, further comprising:\nverifying, by the security module, the integrity of the one or more training datasets; and\ndiscarding, by the security module, any training datasets that do not pass the verification from further use during training of the FrontNet subnet model and BackNet subnet model of the deep learning model.\n6. The method of claim 1, further comprising:\ngenerating, by a fingerprint generation module executing within the trusted execution environment, one or more first fingerprint data structures for the one or more training datasets; and\nstoring, by the fingerprint generation module, the generated one or more first fingerprint data structures in an evidence storage.\n7. The method of claim 6, further comprising:\nprocessing, by the trained deep learning model, new input data to generate an output result and a second fingerprint data structure corresponding to the new input data;\nreceiving, from a client device of the one or more client devices, a query comprising the second fingerprint data structure;\nsearching, by a query module executing in the deep learning training service framework, the evidence storage for a first fingerprint data structure similar to the second fingerprint data structure; and\nidentifying, by the query module, a training dataset, of the one or more training datasets, and a corresponding training dataset provider based on an entry in the evidence storage having a first fingerprint data structure similar to the second fingerprint data structure.\n8. The method of claim 7, further comprising:\nperforming at least one of a debugging operation or a root cause analysis on the trained deep learning model based on the identified training dataset and identified corresponding training dataset provider.\n9. The method of claim 1, wherein the deep learning model is a neural network, the FrontNet subnet model comprises an input layer of the neural network and one or more intermediate layers of the neural network model, and the BackNet subnet model comprises an output layer of the neural network and one or more intermediate layers of the neural network.\n10. The method of claim 1, wherein the trusted execution environment prevents access to the FrontNet subnet model and the one or more decrypted training datasets from outside the trusted execution environment.\n11. A computer program product comprising a computer readable storage medium having a computer readable program stored therein, wherein the computer readable program, when executed on a data processing system, causes the data processing system to implement a deep learning training service framework configured to:\nreceive from one or more client computing devices, one or more encrypted training datasets for training a deep learning model;\nexecute a FrontNet subnet model of the deep learning model in a trusted execution environment of the deep learning training service framework;\nexecute a BackNet subnet model of the deep learning model in the deep learning training service framework external to the trusted execution environment;\ndecrypt, by a security module executing within the trusted execution environment, the one or more encrypted training datasets;\ntrain, by training logic of the deep learning training service framework, the FrontNet subnet model and BackNet subnet model of the deep learning model based on the decrypted training datasets, wherein the FrontNet subnet model is trained within the trusted execution environment and provides intermediate representations to the BackNet subnet model which is trained external to the trusted execution environment using the intermediate representations; and\nrelease a trained deep learning model comprising a trained FrontNet subnet model and a trained BackNet subnet model, to the one or more client computing devices.\n12. The computer program product of claim 11, wherein the one or more client computing devices comprises a plurality of computing devices associated with a plurality of different training dataset providers, and wherein the security module executing within the trusted execution environment prevents training dataset providers from accessing training datasets provided by other training dataset providers.\n13. The computer program product of claim 12, wherein each of the training datasets provided by the different training dataset providers are used during the training of the FrontNet subnet model and the BackNet subnet model of the deep learning model to generate the trained deep learning model, and wherein the same trained deep learning model is released to each of the different training dataset providers.\n14. The computer program product of claim 11, wherein the computer readable program further configures the deep learning training service framework to:\nauthenticate, prior to decrypting the one or more encrypted training datasets, by the security module, training dataset providers of the one or more training dataset providers; and\ndiscard, by the security module, any training datasets from training dataset providers that do not pass the authentication from further use during training of the FrontNet subnet model and BackNet subnet model of the deep learning model.\n15. The computer program product of claim 14, wherein the computer readable program further configures the deep learning training service framework to:\nverify, by the security module, the integrity of the one or more training datasets; and\ndiscard, by the security module, any training datasets that do not pass the verification from further use during training of the FrontNet subnet model and BackNet subnet model of the deep learning model.\n16. The computer program product of claim 11, wherein the computer readable program further configures the deep learning training service framework to:\ngenerate, by a fingerprint generation module executing within the trusted execution environment, one or more first fingerprint data structures for the one or more training datasets; and\nstore, by the fingerprint generation module, the generated one or more first fingerprint data structures in an evidence storage.\n17. The computer program product of claim 16, wherein the computer readable program further configures the deep learning training service framework to:\nprocess, by the trained deep learning model, new input data to generate an output result and a second fingerprint data structure corresponding to the new input data;\nreceive, from a client device of the one or more client devices, a query comprising the second fingerprint data structure;\nsearch, by a query module executing in the deep learning training service framework, the evidence storage for a first fingerprint data structure similar to the second fingerprint data structure; and\nidentify, by the query module, a training dataset, of the one or more training datasets, and a corresponding training dataset provider based on an entry in the evidence storage having a first fingerprint data structure similar to the second fingerprint data structure.\n18. The computer program product of claim 17, wherein the computer readable program further configures the deep learning training service framework to:\nperform at least one of a debugging operation or a root cause analysis on the trained deep learning model based on the identified training dataset and identified corresponding training dataset provider.\n19. The computer program product of claim 11, wherein the deep learning model is a neural network, the FrontNet subnet model comprises an input layer of the neural network and one or more intermediate layers of the neural network model, and the BackNet subnet model comprises an output layer of the neural network and one or more intermediate layers of the neural network.\n20. A system, comprising:\nat least one processor; and\nat least one memory coupled to the at least one processor, wherein the at least one memory comprises instructions which, when executed by the at least one processor, cause the at least one processor to implement a deep learning training service framework configured to:\nreceive from one or more client computing devices, one or more encrypted training datasets for training a deep learning model;\nexecute a FrontNet subnet model of the deep learning model in a trusted execution environment of the deep learning training service framework;\nexecute a BackNet subnet model of the deep learning model in the deep learning training service framework external to the trusted execution environment;\ndecrypt, by a security module executing within the trusted execution environment, the one or more encrypted training datasets;\ntrain, by training logic of the deep learning training service framework, the FrontNet subnet model and BackNet subnet model of the deep learning model based on the decrypted training datasets, wherein the FrontNet subnet model is trained within the trusted execution environment and provides intermediate representations to the BackNet subnet model which is trained external to the trusted execution environment using the intermediate representations; and\nrelease a trained deep learning model comprising a trained FrontNet subnet model and a trained BackNet subnet model, to the one or more client computing devices."
}