{
    "patent_id": "US-11704565-B2",
    "title": "Communication optimizations for distributed machine learning ",
    "assignee": "Intel Corporation",
    "publication_date": "2023-07-18",
    "patent_link": "https://patents.google.com/patent/US11704565B2/en",
    "inventors": [
        "Srinivas Sridharan",
        "Karthikeyan Vaidyanathan",
        "Dipankar Das",
        "Chandrasekaran Sakthivel",
        "Mikhail E. Smorkalov"
    ],
    "classifications": [
        "G06N3/08",
        "G06F9/50",
        "G06F9/5061",
        "G06F9/5077",
        "G06N3/04",
        "G06N3/044",
        "G06N3/045",
        "G06N3/063",
        "G06N3/084",
        "G06N3/088",
        "G06N3/048",
        "G06N7/01"
    ],
    "abstract": "Embodiments described herein provide a system to configure distributed training of a neural network, the system comprising memory to store a library to facilitate data transmission during distributed training of the neural network; a network interface to enable transmission and receipt of configuration data associated with a set of worker nodes, the worker nodes configured to perform distributed training of the neural network; and a processor to execute instructions provided by the library. The instructions cause the processor to create one or more groups of the worker nodes, the one or more groups of worker nodes to be created based on a communication pattern for messages to be transmitted between the worker nodes during distributed training of the neural network. The processor can transparently adjust communication paths between worker nodes based on the communication pattern.",
    "claims": "\n1. A system to configure distributed training of a neural network, the system comprising:\nmemory to store a library to facilitate data transmission during distributed training of the neural network;\na network interface to enable transmission and receipt of configuration data associated with a set of worker nodes, the worker nodes configured to perform distributed training of the neural network, wherein each worker node includes one or more graphics processors to perform compute operations associated with a machine learning framework workflow; and\na processor to execute instructions provided by the library, the instructions to cause the processor to create one or more groups of the worker nodes, the one or more groups of worker nodes to be created based on a communication pattern for messages to be transmitted between the worker nodes during distributed training of the neural network, and the instructions cause the processor to receive a request to transmit parameter data using a first communication pattern and, in response to the request, transparently adjust communication paths between worker nodes based on the first communication pattern.\n2. The system as in claim 1, wherein the first communication pattern is an all-reduce pattern.\n3. The system as in claim 1, wherein the instructions cause the processor to group the worker nodes into one or more groups of topologically local worker nodes and perform an all-reduce synchronization of parameter data between the worker nodes within a group.\n4. The system as in claim 3, wherein the instructions cause the processor to synchronize parameter data between groups via a parameter server.\n5. The system as in claim 4, the instructions to cause the processor to configure a worker node as a parameter server.\n6. The system as in claim 5, the instructions to cause the processor to synchronize parameter data between multiple sets of groups via multiple parameter servers.\n7. The system as in claim 5, the instructions to cause the processor to retrieve a known network topology for a network that interconnects a set of worker nodes and group the worker nodes into one or more groups of topologically local worker nodes based on the known network topology.\n8. The system as in claim 7, the instructions to cause the processor to initiate a sample training iteration on the set of worker nodes and group the worker nodes into one or more groups of worker nodes based on observed latency metrics for communication between the set of worker nodes.\n9. A method comprising:\ntransmitting configuration data associated with a set of worker nodes of a distributed training system configured to perform distributed training of a neural network, wherein each worker node includes one or more graphics processors to perform compute operations associated with a machine learning framework workflow;\ncreating one or more groups of the worker nodes based on a communication pattern for messages to be transmitted between the worker nodes during the distributed training of the neural network; and\nreceiving a request to transmit parameter data using a first communication pattern and, in response to the request, transparently adjust communication paths between the worker nodes based on the first communication pattern.\n10. The method as in claim 9, further comprising:\ngrouping the worker nodes into one or more groups of topologically local worker nodes; and\nperforming an all-reduce synchronization of parameter data between the worker nodes within a group.\n11. The method as in claim 10, further comprising:\nconfiguring a worker node as a parameter server; and\nsynchronizing parameter data between groups via the parameter server.\n12. The method as in claim 11, further comprising synchronizing parameter data between multiple sets of groups via multiple parameter servers.\n13. The method as in claim 12, further comprising:\nretrieving a known network topology for a network that interconnects a set of worker nodes; and\ngrouping the worker nodes into one or more groups of topologically local worker nodes based on the known network topology.\n14. The method as in claim 13, further comprising:\ninitiating a sample training iteration on the set of worker nodes and group the worker nodes into one or more groups of worker nodes based on observed latency metrics for communication between the set of worker nodes.\n15. A non-transitory machine-readable medium storing instructions which, when executed by one or more processors, cause the one or more processors to perform operations comprising:\ntransmitting configuration data associated with a set of worker nodes of a distributed training system configured to perform distributed training of a neural network, wherein each worker node includes one or more graphics processors to perform compute operations associated with a machine learning framework workflow;\ncreating one or more groups of the worker nodes based on a communication pattern for messages to be transmitted between the worker nodes during the distributed training of the neural network; and\nreceiving a request to transmit parameter data using a first communication pattern and, in response to the request, transparently adjust communication paths between the worker nodes based on the first communication pattern.\n16. The non-transitory machine-readable medium as in claim 15, the operations further comprising:\ngrouping the worker nodes into one or more groups of topologically local worker nodes; and\nperforming an all-reduce synchronization of parameter data between the worker nodes within a group.\n17. The non-transitory machine-readable medium as in claim 16, the operations further comprising:\nconfiguring a worker node as a parameter server; and\nsynchronizing parameter data between groups via the parameter server.\n18. The non-transitory machine-readable medium as in claim 17, further comprising synchronizing parameter data between multiple sets of groups via multiple parameter servers.\n19. The non-transitory machine-readable medium as in claim 18, the operations further comprising:\nretrieving a known network topology for a network that interconnects a set of worker nodes; and\ngrouping the worker nodes into one or more groups of topologically local worker nodes based on the known network topology.\n20. The non-transitory machine-readable medium as in claim 19, the operations further comprising:\ninitiating a sample training iteration on the set of worker nodes and group the worker nodes into one or more groups of worker nodes based on observed latency metrics for communication between the set of worker nodes.",
    "status": "Active",
    "citations_own": [
        "DE10353532A1",
        "US20090031070A1",
        "US20090089078A1",
        "US7873812B1",
        "US20110029471A1",
        "CN102708404A",
        "US9164807B2",
        "WO2015192812A1",
        "US20160062947A1",
        "US20160313984A1",
        "US20160352598A1",
        "CN106297774A",
        "US20170153914A1",
        "CN107463990A",
        "US20180005074A1",
        "US20180046906A1",
        "US20180075347A1",
        "US20180322606A1",
        "EP3506095A2",
        "US10891538B2"
    ],
    "citations_ftf": [],
    "citedby_own": [],
    "citedby_ftf": [
        "US11037330B2",
        "US11263162B2",
        "US11270201B2",
        "US10579494B2",
        "US11044495B1",
        "US11687762B2",
        "US10977854B2",
        "US11586907B2",
        "US11645507B2",
        "US11431648B2",
        "US10826851B2",
        "US10909651B2",
        "US10782685B1",
        "US11769041B2",
        "US11526759B2",
        "TWI696961B",
        "CN111353575A",
        "US11520331B2",
        "US11353870B2",
        "US10491240B1",
        "US20200242464A1",
        "US11580371B2",
        "US11580321B2",
        "US10552121B1",
        "US11521042B2",
        "US11003501B2",
        "US11436019B2",
        "US11354579B2",
        "CN110347636A",
        "US11520592B2",
        "US10956776B2",
        "US20220321423A1",
        "US11526761B2",
        "CN110503207A",
        "CN110633796B",
        "US11556450B2",
        "CN113272854A",
        "CN110908799A",
        "US11507840B2",
        "JP2022511581A",
        "WO2021097784A1",
        "CN111210020B",
        "US20220414464A1",
        "CN112988229B",
        "US11521063B1",
        "CN111124696B",
        "CN111208980B",
        "CN111240743B",
        "CN111262917A",
        "CN113128686A",
        "CN111292223B",
        "US11226859B2",
        "US11513860B2",
        "DE102020202093A1",
        "CN110955530A",
        "US11507486B2",
        "US11250538B2",
        "CN113452541B",
        "CN111178522B",
        "CN111507257B",
        "US11681598B2",
        "CN111582494B",
        "CN111552563B",
        "US11394799B2",
        "CN113705801A",
        "CN111813858B",
        "CN111881345B",
        "CN112001351A",
        "KR20230061370A",
        "KR20230062822A",
        "TWI775170B",
        "CN112465112B",
        "CN112381218B",
        "US11782757B2",
        "US11729279B2",
        "US20220222129A1",
        "CN112712171B",
        "CN112748998B",
        "US11271843B1",
        "WO2022225530A1",
        "CN113222118B",
        "CN113487025B",
        "US11385925B1",
        "US11789783B2",
        "EP4120078A1",
        "CN114936117A",
        "CN116017496A",
        "WO2023069130A1",
        "CN113918351B",
        "WO2023193169A1",
        "CN114866429B",
        "CN114820279B",
        "CN115314397B",
        "CN115473854B",
        "CN115271102B",
        "CN115378818B",
        "CN115936095B",
        "CN116149759B"
    ]
}