{
    "patent_id": "US-11037072-B2",
    "title": "Scalable complex event processing with probabilistic machine learning models to predict subsequent geolocations ",
    "assignee": "Retailmenot, Inc.",
    "publication_date": "2021-06-15",
    "patent_link": "https://patents.google.com/patent/US11037072B2/en",
    "inventors": [
        "David John Reese",
        "Annette M. Taberner-Miller",
        "Sankalp Acharya",
        "Lipphei Adam"
    ],
    "classifications": [
        "G06N20/00",
        "G06F16/29",
        "G06N3/044",
        "G06N3/0445",
        "G06N7/005",
        "G06N7/01"
    ],
    "abstract": "Provided is a process, including: obtaining a set of historical geolocations; segmenting the historical geolocations into a plurality of temporal bins; determining pairwise transition probabilities between a set of geographic places based on the historical geolocations; configuring a compute cluster by assigning subsets of the transition probabilities to computing devices in the compute cluster; receiving a geolocation stream indicative of current geolocations of individuals; selecting a computing device in the compute cluster in response to determining that the computing device contain transition probabilities for the received respective geolocation; selecting transition probabilities applicable to the received respective geolocation from among the subset of transition probabilities assigned to the selected computing device; predicting a subsequent geographic place based on the selected transition probabilities.",
    "claims": "\n1. A tangible, non-transitory, machine-readable medium storing instructions that when executed by one or more processors effectuate operations comprising:\naccessing a machine learning model trained to predict subsequent geolocations to be visited, wherein the machine learning model is trained by:\nobtaining a set of historical geolocations of a population of individuals, the set of historical geolocations indicating geographic places visited by the individuals and sequences with which the places were visited;\nobtaining a set of geographic places including at least some corresponding to at least one of the historical geolocations; and\ndetermining parameters of the machine learning model based on pairwise transition probabilities between the set of geographic places that are based on the historical geolocations;\nconfiguring a next-place-prediction stream-processor compute cluster by assigning a first subset of the parameters of the machine learning model to a first computing device in the compute cluster and assigning a second subset of the parameters of the machine learning model to a second computing device in the compute cluster;\nafter configuring the stream-processor compute cluster, receiving, with the stream-processor compute cluster, a geolocation stream indicative of current geolocations of individuals;\nfor each received respective geolocation in the stream, predicting a subsequent geolocation and acting on the prediction, wherein predicting a subsequent geolocation and acting on the prediction comprises:\nselecting a computing device in the compute cluster in response to determining that the computing device contains parameters of the machine learning model corresponding to the received respective geolocation;\nwith the selected computing device, predicting a subsequent geographic place based on the parameters of the machine learning model corresponding to the received respective geolocation;\nselecting content based on the predicted subsequent geographic place; and\ncausing the selected content to be sent to a mobile computing device corresponding to the received respective geolocation.\n2. The medium of claim 1, wherein:\nthe machine learning model comprises a hidden Markov model; and\nthe parameters correspond to transition probabilities between members of the set of geographic places.\n3. The medium of claim 2, wherein:\nthe historical geolocations correspond to an observed variable of the hidden Markov model and an individual's underlying intent correspond to a hidden variable of a hidden Markov model.\n4. The medium of claim 2, wherein:\nselecting content comprises selecting content based on an inferred underlying intent corresponding to the hidden variable.\n5. The medium of claim 2, wherein:\nthe hidden Markov model comprises a three-or-higher dimensional transition probability matrix that is larger than memory of at least one computing device of the next-place-prediction stream-processor compute cluster.\n6. The medium of claim 2, wherein the machine learning model is trained by:\nsteps for determining transition probabilities concurrently.\n7. The medium of claim 1, wherein the machine learning model comprises:\na neural network having a hidden layer with a directed cycle of connections.\n8. The medium of claim 7, wherein the neural network is a discrete time recurrent neural network.\n9. The medium of claim 7, wherein the machine learning model is trained by:\nsteps for training neural nets.\n10. The medium of claim 1, wherein the next-place-prediction stream-processor compute cluster is configured to provide real-time responses to incoming geolocation events.\n11. The medium of claim 1, wherein the next-place-prediction stream-processor compute cluster is configured to provide responses to incoming geolocation events within less than 500 milliseconds of receiving geolocation events.\n12. The medium of claim 1, wherein the next-place-prediction stream-processor compute cluster comprises or is coupled to:\nmeans for compressing a model; and\nmeans for ingesting an event stream.\n13. The medium of claim 1, wherein the next-place-prediction stream-processor compute cluster comprises or is coupled to:\nmeans for emitting a stream of detected patterns; and\nmeans for selecting content and sending selected content.\n14. The medium of claim 1, wherein the content comprises:\nan offer corresponding to the predicted subsequent geographic place.\n15. The medium of claim 14, wherein causing the selected content to be sent to the mobile computing device comprises:\ncausing a geofence corresponding to the predicted subsequent geographic place to be cached by the mobile computing device before the mobile computing device reaches the predicted subsequent geographic place.\n16. The medium of claim 1, wherein the operations comprise:\npruning parameters of the machine learning model to remove values that indicate less than a threshold probability and forming a directed, weighted transition graph from the pruned parameters of the machine learning.\n17. The medium of claim 1, wherein the operations comprise training the machine learning model, and wherein training comprises:\nstoring the set of historical geolocations in a distributed file system of another compute cluster and executing a routine with the other compute cluster to concurrently determine at least some of the parameters of the machine learning model.\n18. The medium of claim 1, wherein predicting the subsequent geolocation comprises:\ningesting the geolocation stream into the compute cluster; and\npredicting the subsequent geographic place with a data pipeline having parallel branches in a topology specified by data transformations and streams between the data transformations.\n19. The medium of claim 1, wherein selecting the computing device in the compute cluster comprises:\nparsing a field from a time-stamped tuple containing the received respective geolocation in the stream; and\nselecting the computing device based on a hash value generated based on the parsed field.\n20. A method, comprising:\naccessing a machine learning model trained to predict subsequent geolocations to be visited, wherein the machine learning model is trained by:\nobtaining a set of historical geolocations of a population of individuals, the set of historical geolocations indicating geographic places visited by the individuals and sequences with which the places were visited;\nobtaining a set of geographic places including at least some corresponding to at least one of the historical geolocations; and\ndetermining parameters of the machine learning model based on pairwise transition probabilities between the set of geographic places based on the historical geolocations;\nconfiguring a next-place-prediction stream-processor compute cluster by assigning a first subset of the parameters of the machine learning model to a first computing device in the compute cluster and assigning a second subset of the parameters of the machine learning model to a second computing device in the compute cluster;\nafter configuring the stream-processor compute cluster, receiving, with the stream-processor compute cluster, a geolocation stream indicative of current geolocations of individuals;\nfor each geolocation in the stream, predicting a subsequent geolocation and acting on the prediction, wherein predicting a subsequent geolocation and acting on the prediction comprises:\nselecting a computing device in the compute cluster in response to determining that the computing device contains parameters of the machine learning model corresponding to the received respective geolocation;\nwith the selected computing device, predicting a subsequent geographic place based on the parameters of the machine learning model corresponding to the received respective geolocation;\nselecting content based on the predicted subsequent geographic place; and\ncausing the selected content to be sent to a mobile computing device corresponding to the received respective geolocation.",
    "status": "Active",
    "citations_own": [],
    "citations_ftf": [
        "WO2007119559A1",
        "WO2008041480A1",
        "US8275649B2",
        "US8737961B2",
        "JP2012003494A",
        "US9122693B2",
        "US9159024B2",
        "US8972357B2",
        "US9064326B1",
        "CN107273437B",
        "US9197498B2",
        "US20140120559A1",
        "US20140304545A1",
        "US9349104B2",
        "US9396253B2",
        "US20150345967A1",
        "US9953086B2",
        "US10120907B2"
    ],
    "citedby_own": [],
    "citedby_ftf": [
        "US10791063B1",
        "US10706970B1",
        "US10541938B1",
        "US10509684B2",
        "US10404787B1",
        "US10515097B2",
        "US10425350B1",
        "US10860622B1",
        "US10812341B1",
        "US10776404B2",
        "US10270707B1",
        "US10511659B1",
        "US10528875B1",
        "US10496926B2",
        "US10505863B1",
        "US10541936B1",
        "US10834042B2",
        "US10044751B2",
        "US10656861B1",
        "US10846350B2",
        "EP3690640B1",
        "US10747592B2",
        "CA2988895A1",
        "US11113244B1",
        "CN110312644B",
        "KR102399535B1",
        "US11037330B2",
        "US10409732B2",
        "US10311405B2",
        "US10581945B2",
        "US11025693B2",
        "US10313413B2",
        "US20200202245A1",
        "US10585698B2",
        "US11599927B1",
        "US10585724B2",
        "US11202175B2",
        "US10924560B2",
        "CN110998648A",
        "US11172324B2",
        "US10705178B2",
        "US11403543B2",
        "US11036700B2",
        "US11545030B2",
        "US11444845B1",
        "GB2583718A",
        "CN110647675B",
        "US11074234B1",
        "CN110851550B",
        "US11753070B2",
        "CN111538907B",
        "CN111709252B",
        "US10877948B1",
        "US11592984B2",
        "CN113420919B",
        "US20230122754A1",
        "CN116362390B"
    ]
}